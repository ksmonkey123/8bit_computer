package ch.awae.custom8bit.microcode

import ch.awae.custom8bit.microcode.ALUInstruction.*
import ch.awae.custom8bit.microcode.Action.*
import ch.awae.custom8bit.microcode.FlagCondition.*

val INSTRUCTION_SET = mapOf(
    "NSWP" to Op.ALU(0x00, NSWP, READ_ALU, WRITE_REGISTER),
    "SHL" to Op.ALU(0x04, SHL, READ_ALU, WRITE_REGISTER),
    "SHR" to Op.ALU(0x08, SHR, READ_ALU, WRITE_REGISTER),
    "DECC" to Op.ALU(0x10, DEC, READ_ALU, WRITE_REGISTER),
    "INCC" to Op.ALU(0x14, INC, READ_ALU, WRITE_REGISTER),
    "ADDC" to Op.ALU(0x18, ADD, READ_ALU, WRITE_REGISTER),
    "SUBC" to Op.ALU(0x1c, SUB, READ_ALU, WRITE_REGISTER),
    "AND" to Op.ALU(0x24, AND, READ_ALU, WRITE_REGISTER),
    "IOR" to Op.ALU(0x28, IOR, READ_ALU, WRITE_REGISTER),
    "XOR" to Op.ALU(0x2c, XOR, READ_ALU, WRITE_REGISTER),
    "NOT" to Op.ALU(0x30, NOT, READ_ALU, WRITE_REGISTER),
    "NAND" to Op.ALU(0x34, NAND, READ_ALU, WRITE_REGISTER),
    "INOR" to Op.ALU(0x38, INOR, READ_ALU, WRITE_REGISTER),
    "XNOR" to Op.ALU(0x3c, XNOR, READ_ALU, WRITE_REGISTER),
    "MOV" to Op(0x40, 0x0f, READ_REGISTER, WRITE_REGISTER),
    "LADD" to Op.ALU(0x50, ADD, READ_ALU_WITH_LITERAL, WRITE_REGISTER, CARRY_SET),
    "LSUB" to Op.ALU(0x54, SUB, READ_ALU_WITH_LITERAL, WRITE_REGISTER, CARRY_CLEAR),
    "LADDC" to Op.ALU(0x58, ADD, READ_ALU_WITH_LITERAL, WRITE_REGISTER),
    "LSUBC" to Op.ALU(0x5c, SUB, READ_ALU_WITH_LITERAL, WRITE_REGISTER),
    "CMPC" to Op.ALU(0x60, CMP, READ_ALU, WRITE_REGISTER),
    "LAND" to Op.ALU(0x64, AND, READ_ALU_WITH_LITERAL, WRITE_REGISTER),
    "LIOR" to Op.ALU(0x68, IOR, READ_ALU_WITH_LITERAL, WRITE_REGISTER),
    "LXOR" to Op.ALU(0x6c, XOR, READ_ALU_WITH_LITERAL, WRITE_REGISTER),
    "CMP" to Op.ALU(0x70, CMP, READ_ALU, WRITE_REGISTER, CARRY_SET),
    "LNAND" to Op.ALU(0x74, NAND, READ_ALU_WITH_LITERAL, WRITE_REGISTER),
    "LINOR" to Op.ALU(0x78, INOR, READ_ALU_WITH_LITERAL, WRITE_REGISTER),
    "LXNOR" to Op.ALU(0x7c, XNOR, READ_ALU_WITH_LITERAL, WRITE_REGISTER),
    "DEC" to Op.ALU(0x80, DEC, READ_ALU, WRITE_REGISTER, CARRY_CLEAR),
    "INC" to Op.ALU(0x84, INC, READ_ALU, WRITE_REGISTER, CARRY_SET),
    "ADD" to Op.ALU(0x88, ADD, READ_ALU, WRITE_REGISTER, CARRY_CLEAR),
    "SUB" to Op.ALU(0x8c, SUB, READ_ALU, WRITE_REGISTER, CARRY_SET),
    "LOAD" to Op(0xa0, 0x03, ADDRESS_FROM_LITERAL, READ_MEMORY, WRITE_REGISTER),
    "ILOAD" to Op(0xa4, 0x03, ADDRESS_FROM_REGISTERS, READ_MEMORY, WRITE_REGISTER),
    "LLOAD" to Op(0xa8, 0x03, READ_LITERAL, WRITE_REGISTER),
    "CLR" to Op(0xac, 0x03, WRITE_REGISTER),
    "STORE" to Op(0xb0, 0x0c, ADDRESS_FROM_LITERAL, READ_REGISTER, WRITE_MEMORY),
    "ISTORE" to Op(0xb1, 0x0c, ADDRESS_FROM_REGISTERS, READ_REGISTER, WRITE_MEMORY),
    "BRCS" to Op(0xc0, IF_CARRY_SET, ADDRESS_FROM_LITERAL, BRANCH),
    "BRCC" to Op(0xc1, IF_CARRY_CLEAR, ADDRESS_FROM_LITERAL, BRANCH),
    "BRZ" to Op(0xc2, IF_ZERO_SET, ADDRESS_FROM_LITERAL, BRANCH),
    "BRNZ" to Op(0xc3, IF_ZERO_CLEAR, ADDRESS_FROM_LITERAL, BRANCH),
    "BRLZ" to Op(0xc4, IF_NEGATIVE_SET, ADDRESS_FROM_LITERAL, BRANCH),
    "BRGZ" to Op(0xc5, IF_NEGATIVE_CLEAR, IF_ZERO_CLEAR, ADDRESS_FROM_LITERAL, BRANCH),
    "BRNLZ" to Op(0xc6, IF_NEGATIVE_CLEAR, ADDRESS_FROM_LITERAL, BRANCH),
    "BRNGZ" to Op(0xc7, (IF_ZERO_SET or IF_NEGATIVE_SET), ADDRESS_FROM_LITERAL, BRANCH),
    "GOTO" to Op(0xc8, ADDRESS_FROM_LITERAL, BRANCH),
    "RGOTO" to Op(0xe8, ADDRESS_FROM_REGISTERS, BRANCH),
    "SETC 0" to Op(0xf0, CARRY_CLEAR),
    "SETC 1" to Op(0xf1, CARRY_SET),
    "NOP" to Op(0xff),
)
